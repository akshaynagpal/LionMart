@import controllers.routes
@import controllers.routes
@import controllers.routes._
@import controllers.routes
@import controllers.routes
@import controllers.routes
@import controllers.routes
@(predictedPrice: Integer)

<!DOCTYPE html>

<html>
    <head>
        <title>Lion Mart</title>
    </head>
    <body>
        <script>
                var FB;
                window.fbAsyncInit = function() {
                    FB.init({
                        appId      : '153128161818624',
                        xfbml      : true,
                        version    : 'v2.6'
                    });
                    FB.Event.subscribe('auth.login', function()
                    {
                        window.location.reload();
                    });
                    FB.getLoginStatus(function(response) {
                        if (response.status === 'connected') {
//                            var uid = response.authResponse.userID;
//                            var accessToken = response.authResponse.accessToken;
//                            console.log(uid);
//                            getUserData();
                        } else if (response.status === 'not_authorized') {
                            console.log("not authorized");
                            gotoHome();
                        } else {
                            console.log("not logged in");
                            gotoHome();
                        }
                    });
                    function getUserData(){

                        FB.api('/me', {fields: 'name,email'},function (response) {
                            var fbID = response.id;
                            var fbName = response.name;
                            var fbEmail = response.email;
                            var baseURL = window.location.href.slice(0,-1);
                            console.log(baseURL);
                            console.log(baseURL+"addUser?fbID="+fbID+"&fbName="+fbName+"&fbEmail="+fbEmail);
                            window.location.replace(baseURL+"addUser?fbID="+fbID+"&fbName="+fbName+"&fbEmail="+fbEmail);
                        });
                    }

                    function gotoHome(){
                        var currentURL = window.location.href;
                        var parts = currentURL.split('/');
                        baseURL = parts[0] + "/";
                        window.location.replace(baseURL);
                    }
                };
                
                (function(d, s, id){
                    var js, fjs = d.getElementsByTagName(s)[0];
                    if (d.getElementById(id)) {return;}
                    js = d.createElement(s); js.id = id;
                    js.src = "//connect.facebook.net/en_US/sdk.js";
                    fjs.parentNode.insertBefore(js, fjs);
                }(document, 'script', 'facebook-jssdk'));
        </script>

        <h1 style="text-align:center">Post Item</h1>
    <form method="POST" action="@routes.Application.processItemForm()" style="text-align: center">
        <table align="center" style="width:40%">
            <tbody>
                <tr>
                    <td colspan="2"><input type="file" name="item_picture" accept="image/*" required></td>
                </tr>
                <tr>
                    <td>Description:</td>
                    <td><textarea name="item_description" style="width:100%" rows="4" maxlength="3000" required></textarea></td>
                </tr>
                <tr>
                    <td>Condition (5=Excellent):</td>
                    <td>
                        <select name="item_condition" style="width:100%">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Months used:</td>
                    <td>
                        <select name="item_months" style="width:100%">
                            <option value="0">Less than 3 months old</option>
                            <option value="1">3-6 months old</option>
                            <option value="2">6 months - 3 years</option>
                            <option value="3"> >3 years</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Price:</td>
                    <td><input id="price" type="number" min="0" max="999999" name="price" style="width:20%;float:left" required>
                        <div style="float:left">$</div></td>
                </tr>

                <tr>
                    <td>Original Price:</td>
                    <td><input id="originalPrice" type="number" min="0" max="999999" name="original_price" style="width:20%;float:left" required>
                        <div style="float:left">$</div></td>
                </tr>
                <tr>
                    <td>Category:</td>
                    <td>
                        <select id = "item_category" name="item_category" style="width:100%">
                            <option value="1">Furniture</option>
                            <option value="2">Tickets</option>
                            <option value="3">Books</option>
                            <option value="4">Electronics</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Online Link (optional) :</td>
                    <td><input type="url" maxlength="255" name="item_link" style="width:100%"></td>
                </tr>
                <tr>
                    <td>Location:</td>
                    <td><input type="text" maxlength="255" name="item_location" style="width:100%" required></td>
                </tr>
            </tbody>
        </table>
        <input type="submit" value="Submit">
    </form>
        <button id="predictPrice">Predict Price</button>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

        <div id="div1">something</div>
        <script type="text/javascript">
                $("#predictPrice").click(function(){
                    $.ajax({
                        type:  'POST',
                        contentType: 'application/json',
                        dataType: 'json',
                        data: JSON.stringify('{"category":"1"}'),
                        url: "@routes.Application.predictPrice()",
                        success: function(json){
                            console.log(json);
                            $("#div1").html("blah");
                        },
                        error: function (result) {
                            console.log("error");
                        },
                    })});
        </script>
    </body>
    </html>